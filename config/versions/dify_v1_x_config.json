{
  "version": "1.7.0",
  "name": "Dify v1.x Configuration",
  "description": "Configuration for Dify v1.x series with enhanced features and OAuth support",
  
  "api": {
    "base_url": "/v1",
    "supported_endpoints": [
      "/v1/chat-messages",
      "/v1/chat-messages/{message_id}/stop",
      "/v1/chat-messages/{message_id}/suggested",
      "/v1/completion-messages",
      "/v1/files/upload",
      "/v1/messages",
      "/v1/messages/{id}/feedbacks",
      "/v1/audio/speech"
    ],
    "authentication": {
      "methods": ["api_key", "oauth2", "query_param"],
      "header_name": "Authorization",
      "header_format": "Bearer {api_key}",
      "oauth": {
        "enabled": true,
        "token_endpoint": "/oauth/token",
        "refresh_endpoint": "/oauth/refresh",
        "scopes": ["read", "write", "admin"]
      },
      "query_param": {
        "enabled": true,
        "param_name": "api_key"
      }
    },
    "response_modes": ["streaming", "blocking"],
    "default_response_mode": "streaming",
    "headers": {
      "x-api-version": "1.7.0",
      "x-trace-id": "auto-generate"
    }
  },
  
  "features": {
    "oauth_support": true,
    "file_upload": true,
    "auto_generate_name": true,
    "external_trace_id": true,
    "plugin_system": true,
    "streaming_mode": true,
    "enhanced_metadata": true,
    "basic_masking": true,
    "conversation_support": true,
    "stop_generation": true,
    "suggested_questions": true,
    "audio_support": true,
    "advanced_retrieval": true,
    "multimodal_support": true
  },
  
  "masking": {
    "enabled": true,
    "patterns": {
      "email": {
        "enabled": true,
        "placeholder_prefix": "EMAIL",
        "regex": "[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}",
        "case_sensitive": false,
        "whole_words_only": false
      },
      "ip_private": {
        "enabled": true,
        "placeholder_prefix": "IP_PRIVATE",
        "regex": "(?:10\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|172\\.(?:1[6-9]|2[0-9]|3[01])\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|192\\.168\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|127\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))",
        "case_sensitive": false,
        "whole_words_only": true
      },
      "ip_public": {
        "enabled": true,
        "placeholder_prefix": "IP_PUBLIC",
        "regex": "(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",
        "exclude_patterns": [
          "(?:10\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|172\\.(?:1[6-9]|2[0-9]|3[01])\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|192\\.168\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)|127\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))"
        ],
        "case_sensitive": false,
        "whole_words_only": true
      },
      "ipv6": {
        "enabled": true,
        "placeholder_prefix": "IPV6",
        "regex": "(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::1|::ffff:[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}|(?:[0-9a-fA-F]{1,4}:)*::(?:[0-9a-fA-F]{1,4}:)*[0-9a-fA-F]{1,4}",
        "case_sensitive": false,
        "whole_words_only": true
      },
      "organization": {
        "enabled": true,
        "placeholder_prefix": "ORG",
        "type": "static_list",
        "values": [
          "Google", "Microsoft", "Apple", "Amazon", "Meta", "Tesla", "Netflix", "Adobe", "Salesforce", "Oracle",
          "IBM", "Intel", "NVIDIA", "AMD", "Qualcomm", "Cisco", "VMware", "ServiceNow", "Workday", "Zoom",
          "Slack", "Dropbox", "Atlassian", "GitHub", "GitLab", "Docker", "Kubernetes", "OpenAI", "Anthropic", "Hugging Face",
          "Databricks", "Snowflake", "Palantir", "Unity", "Roblox", "Shopify", "Square", "Stripe", "Twilio", "Okta"
        ],
        "case_sensitive": false,
        "whole_words_only": true
      },
      "domain": {
        "enabled": true,
        "placeholder_prefix": "DOMAIN",
        "type": "static_list",
        "values": [
          "google.com", "microsoft.com", "apple.com", "amazon.com", "meta.com", "tesla.com", "netflix.com",
          "adobe.com", "salesforce.com", "oracle.com", "ibm.com", "intel.com", "nvidia.com", "amd.com",
          "qualcomm.com", "cisco.com", "vmware.com", "servicenow.com", "workday.com", "zoom.us",
          "slack.com", "dropbox.com", "atlassian.com", "github.com", "gitlab.com", "docker.com",
          "kubernetes.io", "openai.com", "anthropic.com", "huggingface.co", "databricks.com",
          "snowflake.com", "palantir.com", "unity.com", "roblox.com", "shopify.com", "squareup.com",
          "stripe.com", "twilio.com", "okta.com"
        ],
        "case_sensitive": false,
        "whole_words_only": true
      },
      "hostname": {
        "enabled": true,
        "placeholder_prefix": "HOSTNAME",
        "type": "static_list",
        "values": [
          "localhost", "www", "api", "app", "server", "database", "db", "web", "mail", "ftp",
          "staging", "prod", "production", "dev", "development", "test", "testing", "qa",
          "admin", "dashboard", "portal", "gateway", "proxy", "load-balancer", "lb",
          "cdn", "static", "media", "assets", "cache", "redis", "memcached",
          "login", "auth", "oauth", "sso", "ldap", "ad", "identity",
          "monitor", "metrics", "logs", "analytics", "backup", "storage", "files",
          "search", "elastic", "kibana", "grafana", "prometheus", "jenkins", "ci", "cd"
        ],
        "case_sensitive": false,
        "whole_words_only": true
      }
    },
    "json_paths": {
      "request": [
        "$.query",
        "$.inputs.*",
        "$.files[*].content",
        "$.files[*].name"
      ],
      "response": [
        "$.answer",
        "$.data[*].query",
        "$.data[*].answer",
        "$.metadata.retriever_resources[*].content",
        "$.metadata.retriever_resources[*].document_name"
      ]
    }
  },
  
  "request_processing": {
    "endpoints": {
      "/v1/chat-messages": {
        "method": "POST",
        "mask_fields": ["query", "inputs", "files[*].content"],
        "preserve_fields": ["user", "conversation_id", "response_mode", "auto_generate_name"]
      },
      "/v1/chat-messages/{message_id}/stop": {
        "method": "POST",
        "mask_fields": [],
        "preserve_fields": ["user"]
      },
      "/v1/chat-messages/{message_id}/suggested": {
        "method": "GET",
        "mask_fields": [],
        "preserve_fields": []
      },
      "/v1/completion-messages": {
        "method": "POST",
        "mask_fields": ["query", "inputs"],
        "preserve_fields": ["user", "response_mode"]
      },
      "/v1/files/upload": {
        "method": "POST",
        "mask_fields": ["file.content"],
        "preserve_fields": ["user", "file.type", "file.size"]
      },
      "/v1/messages": {
        "method": "GET",
        "mask_fields": [],
        "preserve_fields": ["conversation_id", "limit", "offset"]
      },
      "/v1/messages/{id}/feedbacks": {
        "method": "POST",
        "mask_fields": ["content"],
        "preserve_fields": ["rating"]
      },
      "/v1/audio/speech": {
        "method": "POST",
        "mask_fields": ["text"],
        "preserve_fields": ["user", "voice", "speed"]
      }
    }
  },
  
  "response_processing": {
    "endpoints": {
      "/v1/chat-messages": {
        "unmask_fields": ["answer", "metadata.retriever_resources[*].content"],
        "preserve_fields": ["message_id", "conversation_id", "task_id", "created_at", "metadata.usage"]
      },
      "/v1/chat-messages/{message_id}/stop": {
        "unmask_fields": [],
        "preserve_fields": ["result"]
      },
      "/v1/chat-messages/{message_id}/suggested": {
        "unmask_fields": ["data[*]"],
        "preserve_fields": []
      },
      "/v1/completion-messages": {
        "unmask_fields": ["answer"],
        "preserve_fields": ["message_id", "task_id", "created_at", "metadata.usage"]
      },
      "/v1/files/upload": {
        "unmask_fields": ["name"],
        "preserve_fields": ["id", "size", "extension", "mime_type", "created_at"]
      },
      "/v1/messages": {
        "unmask_fields": ["data[*].query", "data[*].answer"],
        "preserve_fields": ["data[*].message_id", "data[*].conversation_id", "data[*].created_at"]
      },
      "/v1/audio/speech": {
        "unmask_fields": [],
        "preserve_fields": ["task_id"]
      }
    }
  },
  
  "oauth": {
    "enabled": true,
    "client_id": "${OAUTH_CLIENT_ID}",
    "client_secret": "${OAUTH_CLIENT_SECRET}",
    "token_endpoint": "/oauth/token",
    "refresh_endpoint": "/oauth/refresh",
    "revoke_endpoint": "/oauth/revoke",
    "scopes": ["read", "write", "admin"],
    "token_cache": {
      "enabled": true,
      "ttl": 3600,
      "refresh_threshold": 300
    }
  },
  
  "file_upload": {
    "enabled": true,
    "max_file_size": 100000000,
    "allowed_types": ["image/jpeg", "image/png", "image/gif", "image/webp", "application/pdf", "text/plain"],
    "scan_content": true,
    "mask_metadata": true
  },
  
  "external_trace": {
    "enabled": true,
    "header_name": "X-Trace-ID",
    "generate_if_missing": true,
    "format": "uuid",
    "propagate_downstream": true
  },
  
  "enhanced_metadata": {
    "enabled": true,
    "include_usage": true,
    "include_retrieval": true,
    "include_timing": true,
    "mask_retrieval_content": true
  },
  
  "streaming": {
    "enabled": true,
    "chunk_processing": true,
    "real_time_masking": true,
    "buffer_size": 8192
  },
  
  "error_handling": {
    "graceful_degradation": true,
    "fallback_to_passthrough": true,
    "log_errors": true,
    "max_retries": 3,
    "retry_delay": 1000,
    "circuit_breaker": {
      "enabled": true,
      "failure_threshold": 5,
      "recovery_timeout": 30000
    }
  },
  
  "performance": {
    "cache_mappings": true,
    "cache_ttl": 3600,
    "max_cache_size": 50000,
    "enable_compression": true,
    "async_processing": true,
    "connection_pooling": true
  },
  
  "logging": {
    "level": "INFO",
    "include_request_id": true,
    "include_timing": true,
    "include_trace_id": true,
    "mask_sensitive_data": true,
    "structured_logging": true
  },
  
  "monitoring": {
    "enabled": true,
    "metrics": {
      "request_count": true,
      "response_time": true,
      "error_rate": true,
      "masking_operations": true
    },
    "health_check": {
      "endpoint": "/health",
      "include_version": true,
      "include_features": true
    }
  },
  
  "compatibility": {
    "strict_mode": false,
    "ignore_unknown_fields": true,
    "validate_json_schema": true,
    "backward_compatibility": true
  }
}

